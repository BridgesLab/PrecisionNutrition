---
title: "Analysis of Clumped QTLs for TWAS Associations"
author: "Dave Bridges"
date: "2024-10-07"
format: html
---

This file is for looking at genes within the clumped QTL regions for NCD and HFD, and cross-referencing these against TWAS results. This script was last run on `r date()` and can be found in `r getwd()`.

## Data  Entry

Loaded in clumping data and TWAS data

## Load Clumping Data

This is long-format annotated clump data for NCD or HFD GWAS

```{r clump-data}
ncd.clump.filename <- 'ld-calculations/NCD Regions - Annotated.csv'
hfd.clump.filename <- 'ld-calculations/HFD Regions - Annotated.csv'

library(readr)
ncd.clump.data <- read_csv(ncd.clump.filename)
hfd.clump.data <- read_csv(hfd.clump.filename)
```

### TWAS Data

```{r twas-data-entry}
twas.ncd.filename <- 'Cholesterol TWAS - NCD Only - Sex Adjusted.csv' 
twas.hfd.filename <- 'Cholesterol TWAS - HFD Only - Sex Adjusted.csv' 

twas.ncd.data <- read_csv(twas.ncd.filename)
twas.hfd.data <- read_csv(twas.hfd.filename)
```

## High Fat Diet TWAS and QTL Hits

First looked for genes in HFD that were in QTL clumps, and also had TWAS associations under HFD conditions

```{r twas-hfd-overlap}
library(dplyr)
library(knitr)
twas.hfd.data %>%
  filter(symbol %in% hfd.clump.data$external_gene_name) %>% #is in a QTL
  filter(pvalue<0.05) %>%
  dplyr::select(symbol,log2FoldChange,lfcSE,pvalue,padj,chr,start.true,end.true) %>%
  arrange(chr,start.true) %>% 
  kable(caption="Nominally significant TWAS hits inside QTL regions on HFD")
```

## Normal Chow Diet TWAS and QTL Hits

First looked for genes in HFD that were in QTL clumps, and also had TWAS associations under HFD conditions

```{r twas-ncd-overlap}
twas.ncd.data %>%
  filter(symbol %in% ncd.clump.data$external_gene_name) %>% #is in a QTL
  filter(pvalue<0.05) %>%
  dplyr::select(symbol,log2FoldChange,lfcSE,pvalue,padj,chr,start.true,end.true) %>%
  arrange(chr,start.true) %>% 
  kable(caption="Nominally significant TWAS hits inside QTL regions on NCD")
```


# Session Information

```{r session-info}
sessionInfo()
```

